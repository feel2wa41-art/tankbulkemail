version: '3.8'

# Local development Docker Compose
# Usage: docker-compose -f docker-compose.local.yml up -d

services:
  oracle-dev:
    image: container-registry.oracle.com/database/express:21.3.0-xe
    container_name: tank-oracle-dev
    ports:
      - "1521:1521"
    environment:
      - ORACLE_PWD=DevPassword123
    volumes:
      - ./docker/oracle/init:/docker-entrypoint-initdb.d
      - oracle-data:/opt/oracle/oradata
    healthcheck:
      test: ["CMD", "sqlplus", "-L", "sys/DevPassword123@//localhost:1521/XEPDB1 as sysdba", "@healthcheck.sql"]
      interval: 30s
      timeout: 10s
      retries: 5
    networks:
      - tank-local

  redis:
    image: redis:7-alpine
    container_name: tank-redis-dev
    ports:
      - "6379:6379"
    networks:
      - tank-local

networks:
  tank-local:
    driver: bridge

volumes:
  oracle-data:
